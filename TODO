Roadmap
=======

x Basic analyzer (keep track of stack count)
x Basic analyzer (keep track of types)
x Memory opcodes
x Devices (same as enums?)
x String literals
x Variables
x If statement
x Structs
x HERE
x Malloc
  x Basic + free + realloc
  x Defrag
  x Opaque ("void") pointers
  x Maybe0
  x Unit tests
x Remove macros
x Test suite
x Imports
x Arrays (sized, unknown-size)
x Vec
x Metadata
x (r) keyword (use rt-stack)
x Signed numbers
  x Comparison
  x Printing
  x Lexer/Parser
  x Abs/Neg?/Division
x A* pathfinding
  x GetIndex fixes
  x Enums
  x Cond (for Direction/move)
x Refactoring
  x Scopes
  x Explicit main function
  x Decls within decls
x Metadata
- Error messages and context
  - Existing
    - Lexer
    x Parser
    x Analyser
  - Remove panics (except typeref stuff)
    x Lexer
    - Parser
    - Analyser
- Analyser: proper checks
  x End of func
  x Loop body
  x When branches
  - Cond branches
x Fix: inlining func w/ early return
x Fix: inlining func w/ whens/conds/loops

*** v0.1 release ***

- Errors: hints (grep HINT src/errors.zig)
- Errors: additional lines for long messages/context (e.g. error.StackBranching*)
- Fix: proper error reporting on type expr evaluation error
- Fix: memory leaks
- #[] syntax
- Allow wild w/o block
- Loops: break/continue
- Fixed-point
  - Printing
- Solve Effects issue
  - i.e. how to represent effect of quote in arity def?
  - would require being able to "expand" typeref...
  - need major refactoring?
- Make std/alloc faster
  - Auto-merge when freeing (only immediate next block)
  - Remove Header/prev
  - Remove Header/guard* when burdampe is used
- Constant pointers, (const) builtin
  - Constant version of devs (for readonly ports)?

- Static analysis pt 2
  - New analyser pass: track comptime-known vals
  - Devices
    - Chk: is port readable/writeable when calling deo/dei

Optimizations
-------------

- Inline locals
x Eliminate duplicate decls (from generics)
  - E.g. 0 1 swap and 0 (as ptr) 1 (as ptr) swap -> two different functions,
    which is unnecessary (only one needs to be generated)
  - Solution: after spouting out decl at codegen time, check if the generated
    output is exactly the same as another variant, and delete if that's the
    case (and set romloc to that other function's romloc)
    - Change variants field of decl to ASTNodePtrList to make this easy
x Auto-inlining
  - Metadata: always/never inline
- Tail recursion
  - (recurse) builtin

Warnings
--------

- Sprite structs can have metadata to warn if 0-initialized (either not enough
  data or no data)
  - #(warn data-zero-init) #(warn data-incomplete-init)
